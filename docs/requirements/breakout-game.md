# ブロック崩しゲーム要件定義書

## 1. ゲームの概要

ブロック崩しは、パドルを操作してボールを跳ね返し、画面上部に配置されたブロックをすべて破壊することを目的としたアクションゲームです。プレイヤーはパドルを左右に移動させてボールをコントロールし、ブロックを破壊してスコアを獲得します。

### ゲームの目的
- すべてのブロックを破壊してステージをクリアする
- 高スコアを目指す
- ボールを落とさないようにパドルで打ち返し続ける

## 2. 基本的なゲームルール

### 基本ルール
1. **ゲーム開始**: スペースキーまたはクリックでゲームを開始
2. **パドル操作**: 
   - キーボード: 左右矢印キーまたはA/Dキー
   - マウス: マウスの横移動に追従
   - タッチデバイス: タッチ位置に追従
3. **ボールの動き**: 
   - 初期速度で斜め上方向に発射
   - 壁、パドル、ブロックに当たると反射
   - 画面下部に落ちるとライフが1つ減少
4. **ブロック破壊**: 
   - ボールが当たると破壊される
   - ブロックの種類により必要なヒット数が異なる
5. **ゲームオーバー条件**: 
   - ライフが0になる
   - タイムアウト（オプション）
6. **ステージクリア条件**: 
   - すべてのブロックを破壊

## 3. 必要な機能一覧

### コア機能

#### 3.1 パドル
- 横移動機能（キーボード、マウス、タッチ対応）
- 移動速度の調整
- 画面端での移動制限
- ボールとの衝突判定
- 反射角度の計算（パドルの当たる位置により変化）

#### 3.2 ボール
- 物理演算による移動
- 速度ベクトルの管理
- 壁との衝突判定と反射
- パドルとの衝突判定と反射角度計算
- ブロックとの衝突判定
- 加速機能（時間経過またはヒット数に応じて）

#### 3.3 ブロック
- グリッド配置システム
- 複数のブロックタイプ
  - 通常ブロック（1ヒットで破壊）
  - 硬いブロック（2-3ヒットで破壊）
  - 破壊不可能ブロック
- 破壊アニメーション
- スコア値の設定

#### 3.4 スコアシステム
- ブロック破壊時のスコア加算
- コンボボーナス
- ステージクリアボーナス
- ハイスコアの保存（ローカルストレージ）
- スコア表示UI

#### 3.5 ライフシステム
- 初期ライフ数: 3
- ライフ表示UI
- ボール落下時のライフ減少
- ゲームオーバー処理

#### 3.6 UI要素
- タイトル画面
- ゲーム画面
- ポーズメニュー
- ゲームオーバー画面
- ステージクリア画面
- スコア表示
- ライフ表示
- レベル/ステージ表示

## 4. 技術スタック

### 推奨技術スタック

#### オプション1: バニラJavaScript + HTML5 Canvas
- **言語**: JavaScript (ES6+)
- **レンダリング**: HTML5 Canvas API
- **ビルドツール**: Webpack or Vite
- **テスト**: Jest
- **利点**: 軽量、依存関係が少ない、学習しやすい

#### オプション2: React + Canvas
- **フレームワーク**: React 18+
- **状態管理**: Context API or Zustand
- **レンダリング**: React Canvas コンポーネント
- **スタイリング**: CSS Modules or Styled Components
- **ビルドツール**: Vite
- **テスト**: Jest + React Testing Library
- **利点**: コンポーネント化、状態管理が容易、拡張性が高い

#### オプション3: Phaser.js
- **ゲームエンジン**: Phaser 3
- **言語**: TypeScript
- **ビルドツール**: Webpack
- **利点**: ゲーム開発に特化、物理エンジン内蔵、豊富な機能

### 推奨: オプション1（バニラJavaScript + HTML5 Canvas）
シンプルなブロック崩しゲームには十分な機能を提供し、学習曲線も緩やかです。

## 5. 画面サイズとゲーム要素の仕様

### 画面仕様
- **ゲーム画面サイズ**: 800px × 600px
- **背景色**: #000000（黒）
- **境界線**: 2px solid #FFFFFF

### ゲーム要素のサイズ

#### パドル
- **幅**: 100px
- **高さ**: 20px
- **色**: #FFFFFF（白）
- **初期位置**: 画面下部から30px上、中央配置
- **移動速度**: 8px/フレーム

#### ボール
- **直径**: 10px
- **色**: #FFFFFF（白）
- **初期速度**: 5px/フレーム
- **最大速度**: 12px/フレーム
- **加速率**: 0.1px/10ヒット

#### ブロック
- **幅**: 75px
- **高さ**: 25px
- **間隔**: 5px
- **配置**: 8列 × 6行
- **上部余白**: 60px
- **色**: 
  - 通常: #FF0000（赤）、#00FF00（緑）、#0000FF（青）
  - 硬い: #FFD700（金）
  - 破壊不可: #808080（グレー）

### フォント仕様
- **フォントファミリー**: Arial, sans-serif
- **スコア表示**: 24px
- **その他UI**: 16px

## 6. 追加機能の提案

### 6.1 パワーアップシステム
破壊したブロックからランダムでドロップし、パドルでキャッチすると効果発動

#### パワーアップの種類
1. **マルチボール**: ボールが3つに分裂
2. **ワイドパドル**: パドルの幅が1.5倍に拡大（10秒間）
3. **スローボール**: ボールの速度が50%減少（10秒間）
4. **貫通ボール**: ブロックを貫通して破壊（5秒間）
5. **エクストラライフ**: ライフを1つ追加
6. **メガボール**: ボールサイズが2倍（10秒間）

### 6.2 難易度設定
ゲーム開始前に選択可能

#### 難易度レベル
1. **イージー**
   - ボール速度: 遅い
   - パドル幅: 120px
   - ライフ: 5
   - パワーアップ出現率: 30%

2. **ノーマル**
   - ボール速度: 標準
   - パドル幅: 100px
   - ライフ: 3
   - パワーアップ出現率: 20%

3. **ハード**
   - ボール速度: 速い
   - パドル幅: 80px
   - ライフ: 1
   - パワーアップ出現率: 10%
   - ボールの加速率が高い

### 6.3 ステージシステム
- 複数のステージを用意（最低5ステージ）
- ステージごとに異なるブロック配置
- ステージが進むごとに難易度上昇
- 特殊なボスステージ（巨大ブロック）

### 6.4 サウンドシステム
- BGM（ループ再生）
- 効果音
  - ボールヒット音
  - ブロック破壊音
  - パワーアップ取得音
  - ゲームオーバー音
  - ステージクリア音
- 音量調整機能
- ミュート機能

### 6.5 実績システム
- 「初めてのクリア」
- 「ノーミスクリア」
- 「スピードクリア」（3分以内）
- 「パーフェクトゲーム」（全ステージノーミス）
- 「ハイスコアラー」（10,000点達成）

### 6.6 ビジュアルエフェクト
- パーティクルエフェクト（ブロック破壊時）
- 画面揺れ効果（強力なヒット時）
- トレイル効果（ボールの軌跡）
- グラデーション背景
- ネオンスタイルのUI

## 7. 開発フェーズ

### フェーズ1: MVP（最小限の実装）
- 基本的なゲームループ
- パドル、ボール、ブロックの実装
- 衝突判定
- スコア表示

### フェーズ2: コア機能の充実
- ライフシステム
- 複数種類のブロック
- UI画面の実装
- ローカルストレージへのハイスコア保存

### フェーズ3: 追加機能の実装
- パワーアップシステム
- 難易度設定
- サウンドシステム
- ビジュアルエフェクト

### フェーズ4: ポリッシュ
- バグ修正
- パフォーマンス最適化
- レスポンシブ対応
- アクセシビリティ対応

## 8. テスト要件

### ユニットテスト
- 衝突判定ロジック
- スコア計算
- ゲーム状態管理

### 統合テスト
- ゲームループの動作
- UI遷移
- データ永続化

### プレイテスト
- 難易度バランス
- 操作性
- バグの発見

## 9. パフォーマンス目標

- FPS: 60fps維持
- 初期ロード時間: 3秒以内
- メモリ使用量: 50MB以下
- すべての主要ブラウザで動作（Chrome, Firefox, Safari, Edge）

## 10. 今後の拡張可能性

- オンラインランキング
- マルチプレイヤーモード
- レベルエディター
- モバイルアプリ版
- ソーシャル機能（スコアシェア）