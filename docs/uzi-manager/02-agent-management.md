# エージェント管理

## エージェントの統一

### 全フェーズで claude エージェントのみを使用
- 一貫性のある実装品質
- 高度な推論能力による最適な設計
- 複雑な要件の正確な理解

### フェーズ別の claude 配置例
- **テスト作成フェーズ（RED）**: claude:3-4体
- **実装フェーズ（GREEN）**: claude:4-5体
- **リファクタリングフェーズ（REFACTOR）**: claude:2-3体

## TDD特有の並列化戦略

### 効果的な並列化
```bash
# テストケースを機能別に分担（claudeのみ）
uzi prompt --agents claude:3 "認証テスト、データ検証テスト、エラーハンドリングテストをそれぞれ作成"

# 異なる実装アプローチを並行試行（claudeのみ）
uzi prompt --agents claude:4 "同じテストを通過する異なる実装方法を提案"
```

### 避けるべき並列化
- 同一テストファイルへの同時編集
- 依存関係のあるテストケースの並行作成
- 実装前のテストコードのリファクタリング

## テスト駆動の監視ポイント

```bash
# テスト実行の継続監視
uzi run "watch -n 2 'go test ./... -v | grep -E \"(PASS|FAIL)\"'"

# カバレッジの確認
uzi run "go test -cover ./..."

# 特定のテストケースの監視
uzi broadcast "TestUserRegistration のみに集中してください"
```

## エージェント数の制限

現在の設定では最大11体までのエージェントしか同時実行できません。より多くのエージェントが必要な場合：

```yaml
# uzi.yaml
portRange: 3000-3050  # 51個のポートで51体まで可能
# または
portRange: 3000-3100  # 101個のポートで101体まで可能
```

**注意**: 
- あまり多くのエージェントを同時実行するとシステムリソースを大量に消費します
- 各エージェントがtmuxセッション、Gitワークツリー、開発サーバーを持つため、メモリとCPUの使用量に注意が必要です
- 実用的には5-10体程度の同時実行が推奨されます

## マネージャーエージェントの責務

### 1. TDD開発の進行管理
- RED→GREEN→REFACTORの各フェーズを管理
- 各フェーズの品質基準を確保
- フェーズ間の移行判断

### 2. エージェントの統括
- 適切な数とタイプのエージェントを起動
- 各エージェントへの作業割り当て
- 進捗の監視と調整

### 3. 品質管理
- テストカバレッジの確保（目標: 80%以上）
- コード品質の維持
- パフォーマンスの監視

### 4. 進捗報告
- 各フェーズの完了報告
- 問題発生時の即時アラート
- 定期的な状況アップデート